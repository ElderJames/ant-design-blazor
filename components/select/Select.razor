@namespace AntDesign
@inherits AntDomComponentBase

<CascadingValue Value=this>
    <div class="@ClassMapper.Class" style="@Style" id="@Id" @onclick="OnSelectOpenClick" @ref="_selectRef">
        @switch (SelectMode)
        {
            case SelectMode.Default:
                {
                    var selectedOption = SelectedOptions.FirstOrDefault();
                    <div class="ant-select-selector">
                        <span class="ant-select-selection-search">
                            <input autocomplete="off" class="ant-select-selection-search-input" role="combobox"
                                   aria-haspopup="listbox" aria-owns="@(Id)_list" aria-autocomplete="list" aria-controls="@(Id)_list" aria-activedescendant="@(Id)_list_1"
                                   readonly="" unselectable="on" value="" style="opacity: 0;" id="@(Id)" aria-expanded="false" />
                        </span>
                        <span class="ant-select-selection-item">@(selectedOption?.ChildContent)</span>
                    </div>
                    break;
                }
            case SelectMode.Tags:
                {
                    break;
                }
            default:
                {
                    break;
                }
        }

        @if (ShowArrow)
        {
            if (Loading)
            {
                <span class="ant-select-arrow ant-select-arrow-loading" unselectable="on" aria-hidden="true" style="user-select: none;">
                    <span role="img" aria-label="loading" class="anticon anticon-loading">
                        <svg viewBox="0 0 1024 1024" focusable="false" class="anticon-spin" data-icon="loading" width="1em" height="1em" fill="currentColor" aria-hidden="true">
                            <path d="M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"></path>
                        </svg>
                    </span>
                </span>
            }
            else
            {
                <span class="ant-select-arrow" unselectable="on" aria-hidden="true" style="user-select: none;">
                    <span role="img" aria-label="down" class="anticon anticon-down">
                        <svg viewBox="64 64 896 896" focusable="false" class="" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true">
                            <path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z">
                            </path>
                        </svg>
                    </span>
                </span>
                                    
                @if (AllowClear&&Values.Count!=0)
                {
                    <span class="ant-select-clear" unselectable="on" aria-hidden="true" style="user-select: none;" @onclick="OnClearClick">
                        <span role="img" aria-label="close-circle" class="anticon anticon-close-circle">
                            <svg viewBox="64 64 896 896" focusable="false" class="" data-icon="close-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true">
                                <path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm165.4 618.2l-66-.3L512 563.4l-99.3 118.4-66.1.3c-4.4 0-8-3.5-8-8 0-1.9.7-3.7 1.9-5.2l130.1-155L340.5 359a8.32 8.32 0 01-1.9-5.2c0-4.4 3.6-8 8-8l66.1.3L512 464.6l99.3-118.4 66-.3c4.4 0 8 3.5 8 8 0 1.9-.7 3.7-1.9 5.2L553.5 514l130 155c1.2 1.5 1.9 3.3 1.9 5.2 0 4.4-3.6 8-8 8z"></path>
                            </svg>
                        </span>
                    </span>
                }
            }
        }
    </div>
    <div style="position: absolute; top: 0px; left: 0px; width: 100%;" @ref="_dropdownRef">
        <div>
            <div class="@(ClassPrefix)-dropdown @_dropdownClassMapper.Class" style="@_dropdownStyle">
                <div>
                    <div role="listbox" id="@(Id)_list" style="height: 0px; width: 0px; overflow: hidden;">
                        @for (var i = 0; SelectOptions.Count > i; ++i)
                        {
                            var selectOption = SelectOptions[i];
                            <div role="option" id="@(Id)_list_@(i)" aria-selected="@GetAriaSelected(selectOption)">@selectOption.Value</div>
                        }
                    </div>
                    <div class="" style="max-height: 256px; overflow-y: auto">
                        <div>
                            <div class="" style="display: flex; flex-direction: column;">
                                @ChildContent
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</CascadingValue>
